# California Housing ‚Äî Feature Engineering & Preprocessing Pipeline

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ—É—Ç–±—É–∫ **`Cal_Has_Prisec_pipeline.ipynb`**, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç—Ä–æ–∏—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π –ø–∞–π–ø–ª–∞–π–Ω –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–∞—Å–µ—Ç—É *California Housing Prices* –∏ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

## üì¶ –î–∞–Ω–Ω—ã–µ
- –ò—Å—Ç–æ—á–Ω–∏–∫: [Kaggle ‚Äî California Housing Prices](https://www.kaggle.com/datasets/camnugent/california-housing-prices)
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —á–µ—Ä–µ–∑ **`kagglehub`**:
  ```python
  import kagglehub
  from kagglehub import KaggleDatasetAdapter
  df = kagglehub.load_dataset(
      KaggleDatasetAdapter.PANDAS,
      "camnugent/california-housing-prices",
      "housing.csv"
  )
  ```

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫:
- `python>=3.9`
- `pandas`
- `numpy`
- `matplotlib`
- `scikit-learn`
- `folium`
- `kagglehub`

–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pip install pandas numpy matplotlib scikit-learn folium kagglehub
```

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –¥–ª—è —Ä–∞–±–æ—Ç—ã `kagglehub` –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Kaggle (API —Ç–æ–∫–µ–Ω).

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ—É—Ç–±—É–∫ `Cal_Has_Prisec_pipeline.ipynb` –≤ Jupyter/Colab.
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —è—á–µ–π–∫–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑.  
3. –ù–∞ –≤—ã—Ö–æ–¥–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—á–∏—â–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç—ã Folium, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ train/test.

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
1. **–ò–º–ø–æ—Ä—Ç –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –ó–∞–≥—Ä—É–∑–∫–∞ `housing.csv` —á–µ—Ä–µ–∑ `kagglehub`.
2. **–ü–µ—Ä–≤–∏—á–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
   - –ü–æ–¥—Å—á—ë—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤, –±–∞–∑–æ–≤—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∏—Å–ª–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ (`df.hist(...)`).
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ `total_bedrooms` –º–µ–¥–∏–∞–Ω–æ–π:
     ```python
     df["total_bedrooms"].fillna(df["total_bedrooms"].median(), inplace=True)
     ```
4. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**
   - One‚ÄëHot Encoding –¥–ª—è `ocean_proximity` —Å `drop_first=True`:
     ```python
     df = pd.get_dummies(df, columns=["ocean_proximity"], drop_first=True)
     ```
5. **–õ–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π (—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —Ö–≤–æ—Å—Ç–æ–≤)**
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è: `total_rooms`, `total_bedrooms`, `population`, `households` ‚Üí –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å—Ç–æ–ª–±—Ü—ã —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `_log` —á–µ—Ä–µ–∑ `np.log1p`.
6. **–ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (ratio –Ω–∞ –ª–æ–≥–∞—Ö)**
   - `rooms_per_household_log = total_rooms_log / households_log`
   - `bedrooms_per_room_log = total_bedrooms_log / total_rooms_log`
   - `population_per_household_log = population_log / households_log`
7. **–ì–µ–æ–ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è**
   - –ë–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∏—Ä–æ—Ç—ã/–¥–æ–ª–≥–æ—Ç—ã –Ω–∞ —Ä–∞–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (`pd.cut`) –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ–¥–∏–∞–Ω—ã `median_house_value` –≤ —è—á–µ–π–∫–∞—Ö —Å–µ—Ç–∫–∏.
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∫–∏ **Folium** (`folium.Rectangle`) —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º –ø–æ –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ü–µ–Ω–µ; –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –ø–æ `population_per_household_log`.
8. **–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è**
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `median_house_value_log = log1p(median_house_value)` –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏—Å—Ö–æ–¥–Ω–æ–π –∏ –ª–æ–≥‚Äë—Ü–µ–ª–∏.
9. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**
   - `StandardScaler` ‚Üí `X_sscaled` (–≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ `X` –∫—Ä–æ–º–µ —Ü–µ–ª–µ–≤–æ–π).
   - `MinMaxScaler(0..1)` ‚Üí `X_mmscaled` —Ç–æ–ª—å–∫–æ –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤.
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º ¬´–æ—Ä–∏–≥–∏–Ω–∞–ª vs StandardScaler vs MinMaxScaler`¬ª.
10. **–†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏**
    ```python
    X = df.drop(columns=["median_house_value_log"])
    y = df["median_house_value_log"]
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.2, random_state=42, shuffle=True
    )
    ```

## üß± –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ
- –ë–∞–∑–æ–≤—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ (–∫—Ä–æ–º–µ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤ –ø–æ—Å–ª–µ –ª–æ–≥‚Äë–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π).
- One‚ÄëHot —Å—Ç–æ–ª–±—Ü—ã –ø–æ `ocean_proximity` (—Å `drop_first`).
- –õ–æ–≥‚Äë–ø—Ä–∏–∑–Ω–∞–∫–∏: `*_log` –¥–ª—è: `total_rooms`, `total_bedrooms`, `population`, `households`.
- –°–≤–æ–¥–Ω—ã–µ ratio‚Äë–ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞ –ª–æ–≥–∞—Ö:
  - `rooms_per_household_log`
  - `bedrooms_per_room_log`
  - `population_per_household_log`
- –¶–µ–ª—å: `median_house_value_log`.

## üåç –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ ¬´–¥–æ/–ø–æ—Å–ª–µ¬ª.
- –î–≤–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç—ã Folium:
  1) –º–µ–¥–∏–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã –ø–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–µ—Ç–∫–µ,
  2) –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ ¬´–≤—ã–±—Ä–æ—Å–Ω—ã—Ö¬ª —è—á–µ–µ–∫ –ø–æ `population_per_household_log`.

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å
- `test_size=0.2` –∏ `random_state=42` –≤ `train_test_split`.
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏–Ω–æ–≤ –ø–æ —à–∏—Ä–æ—Ç–µ/–¥–æ–ª–≥–æ—Ç–µ (–≤ –Ω–æ—É—Ç–±—É–∫–µ ‚Äî —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–∞—è —Å–µ—Ç–∫–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 100√ó100).
- –ü–æ—Ä–æ–≥ –¥–ª—è –æ—Ç–±–æ—Ä–∞ ¬´–≤—ã–±—Ä–æ—Å–æ–≤¬ª –ø–æ `population_per_household_log` (–≤ –Ω–æ—É—Ç–±—É–∫–µ ‚Äî —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç `> log1p(100)`).

## üìÑ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã/–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `df` ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ —Ü–µ–ª–µ–≤–æ–π.
- `X_sscaled`, `X_mmscaled` ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (DataFrame).
- `X_train, X_test, y_train, y_test` ‚Äî —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏–∏.
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã **Folium** `m` (–∫–∞—Ä—Ç–∞ —Å–µ—Ç–∫–∏) –∏ –∫–∞—Ä—Ç–∞ ¬´–≤—ã–±—Ä–æ—Å–æ–≤¬ª.

## üß™ –ß—Ç–æ –¥–∞–ª—å—à–µ?
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `LinearRegression`) –Ω–∞ `X_train/y_train`, –º–µ—Ç—Ä–∏–∫–∏ `RMSE` –∏ `R¬≤` –Ω–∞ `X_test/y_test`.
- –°—Ä–∞–≤–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—ã—Ä–æ–π, StandardScaler –∏ MinMaxScaler –≤–µ—Ä—Å–∏—è—Ö.
- –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏ (`joblib`/`pickle`) –∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å‚Äë—Å–∫—Ä–∏–ø—Ç.

---

**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT (–∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ –≤–∞—à—É).  
**–ê–≤—Ç–æ—Ä:** (–≤—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ—ë –∏–º—è/–Ω–∏–∫).

